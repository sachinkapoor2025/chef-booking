<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maharaja Chef Services - Chatbot</title>
    <style>
        :root {
            --brand-gradient: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            --brand-gradient-hover: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            --brand-shadow: 0 4px 14px rgba(59, 130, 246, 0.35);
        }

        .chatbot-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
            font-family: 'Arial', sans-serif;
        }

        .chatbot-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--brand-gradient);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--brand-shadow);
            transition: all 0.3s ease;
            font-weight: bold;
            font-size: 14px;
        }

        .chatbot-toggle:hover {
            background: var(--brand-gradient-hover);
            transform: scale(1.08);
        }

        .chatbot-popup {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 350px;
            height: 500px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
            display: none;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }

        .chatbot-header {
            background: var(--brand-gradient);
            color: white;
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--brand-shadow);
        }

        .chatbot-header h3 {
            margin: 0;
            font-size: 16px;
            font-weight: 600;
        }

        .chatbot-header img {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            margin-right: 10px;
        }

        .chatbot-close {
            background: none;
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
        }

        .chatbot-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: #f8fafc;
        }

        .chatbot-message {
            margin-bottom: 15px;
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 18px;
            word-wrap: break-word;
        }

        .chatbot-message.user {
            background: var(--brand-gradient);
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }

        .chatbot-message.bot {
            background-color: #ffffff;
            color: #1e293b;
            margin-right: auto;
            border-bottom-left-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .message-time {
            font-size: 10px;
            opacity: 0.7;
            margin-top: 3px;
            text-align: right;
        }

        .chatbot-typing {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
            background-color: #ffffff;
            padding: 10px 15px;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .chatbot-typing-dot {
            width: 8px;
            height: 8px;
            background-color: #3b82f6;
            border-radius: 50%;
            margin: 0 2px;
            animation: typing 1.4s infinite ease-in-out;
        }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-5px); }
        }

        .chatbot-input-area {
            padding: 15px;
            background-color: white;
            border-top: 1px solid #e0e0e0;
        }

        .language-selector select {
            width: 100%;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 10px;
        }

        .chatbot-input-container {
            display: flex;
            gap: 10px;
        }

        .chatbot-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 14px;
        }

        .chatbot-input:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 2px rgba(59,130,246,0.25);
            outline: none;
        }

        .chatbot-send {
            background: var(--brand-gradient);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 14px;
            box-shadow: var(--brand-shadow);
        }

        .chatbot-send:hover {
            background: var(--brand-gradient-hover);
        }

        @media (max-width: 768px) {
            .chatbot-popup {
                width: 90%;
                height: 80vh;
                right: 5%;
                left: 5%;
            }
        }

        .chatbot-popup.show {
            animation: slideUp 0.3s ease-out forwards;
        }

        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>

<body>
<div class="chatbot-container">
    <button class="chatbot-toggle" id="chatbotToggle">Chat</button>

    <div class="chatbot-popup" id="chatbotPopup">
        <div class="chatbot-header">
            <div style="display:flex;align-items:center;">
                <img src="../images/logo.jpg" alt="Maharaja Chef Services">
                <h3>Maharaja Chef Chat</h3>
            </div>
            <button class="chatbot-close" id="chatbotClose">&times;</button>
        </div>

        <div class="chatbot-messages" id="chatbotMessages">
            <div class="chatbot-message bot">
                Hello! Welcome to Maharaja Chef Services. How can I help you today?
                <div class="message-time">Just now</div>
            </div>
        </div>

        <div class="chatbot-input-area">
            <div class="language-selector">
                <select id="languageSelect">
                    <option value="en">English</option>
                    <option value="es">Spanish</option>
                    <option value="zh">Chinese</option>
                    <option value="tag">Tagalog</option>
                    <option value="vi">Vietnamese</option>
                    <option value="fr">French</option>
                    <option value="ar">Arabic</option>
                    <option value="ko">Korean</option>
                    <option value="ru">Russian</option>
                    <option value="de">German</option>
                    <option value="hi">Hindi</option>
                    <option value="pt">Portuguese</option>
                    <option value="it">Italian</option>
                    <option value="ja">Japanese</option>
                    <option value="pl">Polish</option>
                    <option value="uk">Ukrainian</option>
                    <option value="ht">Haitian Creole</option>
                    <option value="bn">Bengali</option>
                    <option value="pa">Punjabi</option>
                    <option value="tl">Filipino</option>
                </select>
            </div>

            <div class="chatbot-input-container">
                <input type="text" class="chatbot-input" id="chatbotInput" placeholder="Type your message...">
                <button class="chatbot-send" id="chatbotSend">Send</button>
            </div>
        </div>
    </div>
</div>

<script>
(function() {
    const chatbotToggle = document.getElementById('chatbotToggle');
    const chatbotPopup = document.getElementById('chatbotPopup');
    const chatbotClose = document.getElementById('chatbotClose');
    const chatbotSend = document.getElementById('chatbotSend');
    const chatbotInput = document.getElementById('chatbotInput');
    const chatbotMessages = document.getElementById('chatbotMessages');
    const languageSelect = document.getElementById('languageSelect');

    let sessionId = localStorage.getItem('chatSessionId') || ('chat-' + Math.random().toString(36).substr(2,9));
    let isTyping = false;

    chatbotToggle.onclick = chatbotClose.onclick = () => {
        chatbotPopup.style.display = chatbotPopup.style.display === 'flex' ? 'none' : 'flex';
        chatbotPopup.classList.add('show');
        chatbotInput.focus();
    };

    chatbotSend.onclick = sendMessage;
    chatbotInput.onkeypress = e => e.key === 'Enter' && sendMessage();

    async function sendMessage() {
        const msg = chatbotInput.value.trim();
        if (!msg || isTyping) return;
        addMessage('user', msg);
        chatbotInput.value = '';
        showTyping();

        try {
            const res = await fetch('https://fated6vcp8.execute-api.us-east-1.amazonaws.com/prod/chat', {
                method: 'POST',
                headers: {'Content-Type':'application/json'},
                body: JSON.stringify({ message: msg, language: languageSelect.value, sessionId })
            });
            const data = await res.json();
            hideTyping();
            addMessage('bot', data.message || 'Sorry, something went wrong.');
        } catch {
            hideTyping();
            addMessage('bot', 'Connection error. Please try again.');
        }
    }

    function addMessage(role, text) {
        const div = document.createElement('div');
        div.className = `chatbot-message ${role}`;
        div.innerHTML = text + `<div class="message-time">${new Date().toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'})}</div>`;
        chatbotMessages.appendChild(div);
        chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
    }

    function showTyping() {
        isTyping = true;
        const div = document.createElement('div');
        div.className = 'chatbot-typing';
        for(let i=0;i<3;i++){
            const dot=document.createElement('span');
            dot.className='chatbot-typing-dot';
            div.appendChild(dot);
        }
        chatbotMessages.appendChild(div);
    }

    function hideTyping() {
        isTyping = false;
        document.querySelectorAll('.chatbot-typing').forEach(e=>e.remove());
    }
})();
</script>
</body>
</html>
