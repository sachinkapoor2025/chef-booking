<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 20px;
        }
        .test-result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
    </style>
</head>
<body>
    <h1>üß™ Chatbot Test</h1>

    <div id="testResults">
        <div class="test-result info">
            <strong>Testing chatbot functionality...</strong>
        </div>
    </div>

    <script>
        // Test chatbot loading
        async function testChatbot() {
            const resultsDiv = document.getElementById('testResults');

            try {
                // Test 1: Check if chatbot.html exists
                addResult("info", "Test 1: Checking if chatbot.html exists...");
                const response = await fetch('website/chatbot.html');
                if (response.ok) {
                    addResult("success", "‚úÖ chatbot.html found successfully");
                } else {
                    addResult("error", "‚ùå chatbot.html not found");
                    return;
                }

                // Test 2: Check if chatbot HTML is valid
                addResult("info", "Test 2: Validating chatbot HTML structure...");
                const html = await response.text();
                if (html.includes('chatbot-container') && html.includes('chatbot-toggle')) {
                    addResult("success", "‚úÖ Chatbot HTML structure is valid");
                } else {
                    addResult("error", "‚ùå Chatbot HTML structure is invalid");
                    return;
                }

                // Test 3: Check if index.html has chatbot integration
                addResult("info", "Test 3: Checking index.html for chatbot integration...");
                const indexResponse = await fetch('website/index.html');
                const indexHtml = await indexResponse.text();
                if (indexHtml.includes('chatbot.html') && indexHtml.includes('fetch')) {
                    addResult("success", "‚úÖ index.html has chatbot integration");
                } else {
                    addResult("error", "‚ùå index.html missing chatbot integration");
                    return;
                }

                // Test 4: Check API endpoints
                addResult("info", "Test 4: Checking if API endpoints are configured...");
                const templateResponse = await fetch('backend/template.yaml');
                const templateYaml = await templateResponse.text();
                if (templateYaml.includes('ChatbotFunction') && templateYaml.includes('/chat')) {
                    addResult("success", "‚úÖ API endpoints are configured in CloudFormation");
                } else {
                    addResult("error", "‚ùå API endpoints missing from CloudFormation");
                    return;
                }

                // Final success
                addResult("success", "üéâ All tests passed! Chatbot should be working correctly.");

            } catch (error) {
                addResult("error", `‚ùå Error during testing: ${error.message}`);
                console.error('Test error:', error);
            }
        }

        function addResult(type, message) {
            const resultsDiv = document.getElementById('testResults');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.innerHTML = `<strong>${message}</strong>`;
            resultsDiv.appendChild(resultDiv);
        }

        // Run tests when page loads
        testChatbot();
    </script>
</body>
</html>
